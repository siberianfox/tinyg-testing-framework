###############################################################################
#### Startup tests
###############################################################################

---

###############################################################################
#### Start of actual data for the tests
###############################################################################

#### Global values 
min_fb: 80
min_hv: 6

#### Preconditions for all tests (runs from before_all() )
precondition:
  
  setValues:   # These run before() all tests (test setup). Ordering is important
    - js: 1    # Should set JSON to strict mode-- for JS parsing
    - ee: 0    # Should disable echo and set JSON mode	-- do this first or responses will get confused
    - js: 1    # Should set JSON to strict mode-- for JS parsing
    - fd: 0    # Should set footer depth
    - ex: 2    # Should set flow control to RTS/CTS
    - jv: 5    # Should set JSON verbosity to max
    - tv: 1    # Should set text to verbose
    - qv: 0    # Should turn queue reports off
    - sv: 1    # Should set status report verbosity to filtered
    - si: 250  # Should set status interval
    - ew: 0    # Should disable window mode
    - hv: 8    # Should set HW version to v8

  setValuesEach: # These run before each test. Try to keep this short -- it makes debugging harder
    - ee: 0    # Should disable echo and set JSON mode

  reportParameters:
    - id
    - fv
    - fb
    - cv
    - hp
    - hv

# System structure test data
sys:
  propertyList:
    - fb
    - fv
    - hv
    - ja
    - ct
    - mt
    - ej
    - jv
    - tv
    - qv
    - sv
    - si

gcodeDefaults:
  propertyList:
    - gpl
    - gun
    - gco
    - gpa
    - gdi

###############################################################################
#### Parameter tests
###############################################################################
#
# See here for parameters: http://github.com/synthetos/tinyg/wiki/...
#
# Syntax:
#
# Required: 
#   "parameters:" as an array OR "parameter:" as a string,
#   "value" as the value to send
#
# Optional:
#   "description:" will output a line of descriptive text. Ex:
#     description: "firmware build - supposed to be read-only"
#
#   "returns:" OR "exists:" OR "hasKeys:" OR "exactKeys:" (only one, or none). Ex:
#     returns: 2
#     exists: 1
#     hasKeys: [fb, fv]
#     exactKeys: [fb, fv, cv, hp, hv, id]
#
#   "status:" - assumes status=0 if missing (status=0 is the OK status code)
#               status codes ref: http://github.com/synthetos/tinyg/TinyG-Status-Codes
#
#   Options for values for returns:, exists:, hasKeys:, exactKeys:, and status:
#   - give an array for returns: for an inclusive range - returns: [0, 10] matches 0 <= x <= 10
#   - give a non-null value for returns: to match exactly
#   - give exists: 1 to match any non-null response
#   - give a null value for returns: (or give none of returns:, exists:, hasKeys:, or exactKeys:) 
#     to match null or undefined response
#   - give hasKeys as an array of key names that must exist, but other keys may also exist
#   - give exactKeys as an array of key names than must match exactly, 
#     there must be exactly those keys in the response, no more, no less
#   - give a status: value to match - so that a non-zero status can be interpreted as success

setParameterTests:

  ### Generic failure cases (no parameters)

  - description: "Should reject unrecognized tag"
    parameter: madeup  # this test fails
    value: null
    status: 100

  - description: "Should reject null tag"
    parameter: null
    value: null
    status: 100
  
  ### System IDs ###

#  - description: "read firmware build"
  - parameter: fb
    value: null
    exists: 1

  - description: "firmware build - supposed to be read-only"
    parameter: fb
    value: 999.99
    exists: 0
    status: 3
#    status: 107

  - description: "firmware version - supposed to be read-only"
    parameter: fv
    value: 999.99
    exists: 0
    status: 3
#    status: 107

  - description: "configuration version - supposed to be read-only"
    parameter: cv
    value: 2
    exists: 0
    status: 3
#    status: 107

  - description: "hardware platform - supposed to be read-only"
    parameter: hp
    value: 99
    exists: 0
    status: 3
#    status: 107

